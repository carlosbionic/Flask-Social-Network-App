{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Individual blog post{% endblock %}</h1>
{% endblock %}

{% block content %}
    <article class="post">
        <header>
            <div>
                <h1>{{ post['title'] }}</h1>
                <div class="about">by {{ post['username'] }} on {{ post['created'].strftime('%Y-%m-%d') }}</div>
            </div>
        </header>
        <p class="body">{{ post['body'] }}</p>
        
        <!-- LIKES/DISLIKES -->
        <div class="likes">
            {% set likeP = False if session['user_id']|string == '' else session['user_id']|string in post['likers'].split(',') %}
            {% set dislikeP = False if session['user_id']|string == '' else session['user_id']|string in post['dislikers'].split(',') %}

            {% set likers_list = post['likers'].split(',') %}
            {% set dislikers_list = post['dislikers'].split(',') %}

            {% set likes_count = 0 if (likers_list|length == 1 and likers_list[0] == '') else likers_list|length %}
            {% set dislikes_count = 0 if (dislikers_list|length == 1 and dislikers_list[0] == '') else dislikers_list|length %}
            
            <a class="like {% if likeP %} likeActive {% endif %}" href="{{ url_for('blog.like_post', id=post['id'], likeOrDislike='like') }}">👍 {{ likes_count }}</a>
            <a class="dislike {% if dislikeP %} likeActive {% endif %}" href="{{ url_for('blog.like_post', id=post['id'], likeOrDislike='dislike') }}">👎 {{ dislikes_count }}</a>
        </div>
    </article>
{% endblock %}